<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- modelviewserver.qdoc -->
  <meta name="description" content="Developing a simple server program that displays and makes changes to a QTreeView which is made available on a Remote Objects network.">
  <title>Model-View Server | Qt Remote Objects 6.6.2</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li><a href="../qtdoc/index.html" translate="no">Qt 6.6</a></li>
<li><a href="qtremoteobjects-index.html" translate="no">Qt Remote Objects</a></li>
<li><a href="qtremoteobjects-examples.html" translate="no">Qt Remote Objects Examples</a></li>
<li>Model-View Server</li>
<li id="buildversion"><a href="qtremoteobjects-index.html" translate="no">Qt 6.6.2 Reference Documentation</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar"><div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Model-View Server</h1>
<!-- $$$modelviewserver-brief -->
<p>Developing a simple server program that displays and makes changes to a QTreeView which is made available on a Remote Objects network.</p>
<!-- @@@modelviewserver -->
<!-- $$$modelviewserver-description -->
<div class="descr" id="details">
<p>This is the server-side application that accompanies the <a href="qtremoteobjects-modelviewclient-example.html" translate="no">Model-View Client</a>.</p>
<pre class="cpp" translate="no">
     <span class="type"><a href="qremoteobjectregistryhost.html" translate="no">QRemoteObjectRegistryHost</a></span> node(<span class="type"><a href="../qtcore/qurl.html" translate="no">QUrl</a></span>(<span class="type"><a href="../qtcore/qstring.html#QStringLiteral" translate="no">QStringLiteral</a></span>(<span class="string">&quot;local:registry&quot;</span>)));
</pre>
<p>We start by creating a <a href="qremoteobjectregistryhost.html" translate="no">QRemoteObjectRegistryHost</a> with which other Remote Objects will connect, be registered and then be advertised by. The model we create can then be easily acquired from the client side by just connecting to the registry.</p>
<pre class="cpp" translate="no">
     std<span class="operator">::</span>unique_ptr<span class="operator">&lt;</span><span class="type">QStandardItemModel</span><span class="operator">&gt;</span> sourceModel <span class="operator">=</span> createModel();

     <span class="type"><a href="../qtcore/qlist.html" translate="no">QList</a></span><span class="operator">&lt;</span><span class="type">int</span><span class="operator">&gt;</span> roles;
     roles <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>BackgroundRole;
</pre>
<p>Now we have to create the model we need. The exact implementation is available in the source code, to which you can navigate by pressing the link further down on this page. We also define which <i>roles</i> we want to expose to the <a href="qtremoteobjects-replica.html#replica" translate="no">Replica</a> on the client side.</p>
<pre class="cpp" translate="no">
     <span class="type"><a href="qremoteobjecthost.html" translate="no">QRemoteObjectHost</a></span> node2(<span class="type"><a href="../qtcore/qurl.html" translate="no">QUrl</a></span>(<span class="type"><a href="../qtcore/qstring.html#QStringLiteral" translate="no">QStringLiteral</a></span>(<span class="string">&quot;local:replica&quot;</span>))<span class="operator">,</span> <span class="type"><a href="../qtcore/qurl.html" translate="no">QUrl</a></span>(<span class="type"><a href="../qtcore/qstring.html#QStringLiteral" translate="no">QStringLiteral</a></span>(<span class="string">&quot;local:registry&quot;</span>)));
     node2<span class="operator">.</span>enableRemoting(sourceModel<span class="operator">.</span>get()<span class="operator">,</span> <span class="type"><a href="../qtcore/qstring.html#QStringLiteral" translate="no">QStringLiteral</a></span>(<span class="string">&quot;RemoteModel&quot;</span>)<span class="operator">,</span> roles);
</pre>
<p>Here, we create the <a href="qremoteobjecthost.html" translate="no">QRemoteObjectHost</a> that connects to, and shares all its Remote Objects with, the Registry we created earlier. We then start remoting the model we just created with the name <code translate="no">RemoteModel</code>. We also pass the <i>roles</i> argument here.</p>
<pre class="cpp" translate="no">
     <span class="type">QTreeView</span> view;
     view<span class="operator">.</span>setWindowTitle(<span class="type"><a href="../qtcore/qstring.html#QStringLiteral" translate="no">QStringLiteral</a></span>(<span class="string">&quot;SourceView&quot;</span>));
     view<span class="operator">.</span>setModel(sourceModel<span class="operator">.</span>get());
     view<span class="operator">.</span>show();
</pre>
<p>We then display the model with a QTreeView widget.</p>
<pre class="cpp" translate="no">
     TimerHandler handler;
     handler<span class="operator">.</span>model <span class="operator">=</span> sourceModel<span class="operator">.</span>get();
     <span class="type"><a href="../qtcore/qtimer.html" translate="no">QTimer</a></span><span class="operator">::</span>singleShot(<span class="number">5000</span><span class="operator">,</span> <span class="operator">&amp;</span>handler<span class="operator">,</span> <span class="operator">&amp;</span>TimerHandler<span class="operator">::</span>changeData);
     <span class="type"><a href="../qtcore/qtimer.html" translate="no">QTimer</a></span><span class="operator">::</span>singleShot(<span class="number">10000</span><span class="operator">,</span> <span class="operator">&amp;</span>handler<span class="operator">,</span> <span class="operator">&amp;</span>TimerHandler<span class="operator">::</span>insertData);
     <span class="type"><a href="../qtcore/qtimer.html" translate="no">QTimer</a></span><span class="operator">::</span>singleShot(<span class="number">11000</span><span class="operator">,</span> <span class="operator">&amp;</span>handler<span class="operator">,</span> <span class="operator">&amp;</span>TimerHandler<span class="operator">::</span>changeFlags);
     <span class="type"><a href="../qtcore/qtimer.html" translate="no">QTimer</a></span><span class="operator">::</span>singleShot(<span class="number">12000</span><span class="operator">,</span> <span class="operator">&amp;</span>handler<span class="operator">,</span> <span class="operator">&amp;</span>TimerHandler<span class="operator">::</span>removeData);
     <span class="type"><a href="../qtcore/qtimer.html" translate="no">QTimer</a></span><span class="operator">::</span>singleShot(<span class="number">13000</span><span class="operator">,</span> <span class="operator">&amp;</span>handler<span class="operator">,</span> <span class="operator">&amp;</span>TimerHandler<span class="operator">::</span>moveData);
</pre>
<p>For the sake of keeping the example light-weight it performs some automated actions to affect the model shortly after the server application launches. These changes can then be seen on both the server and client side. You can also change the text in the fields on the server side and see it update on the client side.</p>
<p><a href="https://code.qt.io/cgit/qt/qtremoteobjects.git/tree/examples/remoteobjects/modelviewserver?h=6.6" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@modelviewserver -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2024 <span translate="no">The Qt Company Ltd.</span>
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the <span translate="no">Free Software Foundation</span>.<br/>    <span translate="no">Qt</span> and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of <span translate="no">The Qt Company Ltd.</span> in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>
</div>
</body>
</html>
