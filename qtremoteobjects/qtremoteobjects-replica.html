<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- remoteobjects-replica.qdoc -->
  <meta name="description" content="Describes the concept of a replica and how it works as a surrogate object.  A QRemoteObjectReplica (&quot;replica&quot;) is a surrogate object that has approximately the same API as the Source QObject it replicates. Additionally, there are a few properties and signals to make it possible to detect when the replica is initialized or if it loses its connection to the source object. There are a few other differences, notably, a constant property on the source cannot be constant on the replica. The value will not be known at the time when the replica is instantiated; it will only be known once the replica is initialized. For more information, see Remote Object Interaction.">
  <title>Qt Remote Objects Replica | Qt Remote Objects 6.6.2</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li><a href="../qtdoc/index.html" translate="no">Qt 6.6</a></li>
<li><a href="qtremoteobjects-index.html" translate="no">Qt Remote Objects</a></li>
<li>Qt Remote Objects Replica</li>
<li id="buildversion"><a href="qtremoteobjects-index.html" translate="no">Qt 6.6.2 Reference Documentation</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3 id="toc">Contents</h3>
<ul>
<li class="level1"><a href="#replica-initialization">Replica Initialization</a></li>
<li class="level1"><a href="#replica-ownership">Replica Ownership</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Qt Remote Objects Replica</h1>
<!-- $$$qtremoteobjects-replica.html-description -->
<div class="descr" id="details">
<p>A compiled replica is a <a href="qremoteobjectreplica.html" translate="no">QRemoteObjectReplica</a> based type, where the derived class definition is automatically generated by the <a href="qtremoteobjects-repc.html" translate="no">repc</a> compiler. When you use <a href="qtremoteobjects-repc.html#cmake-functions" translate="no">CMake functions</a> or <a href="qtremoteobjects-repc.html#qmake-variables" translate="no">qmake variables</a> for running the <a href="qtremoteobjects-repc.html" translate="no">repc</a> compiler, this makes the generation part of the build process. Although only a header is generated, it's a complete type. There is no public constructor, so you need to use the <a href="qremoteobjectnode.html#acquire" translate="no">QRemoteObjectNode::acquire</a> template function to create the Replica instance.</p>
<p>A <a href="qremoteobjectdynamicreplica.html" translate="no">QRemoteObjectDynamicReplica</a> can be generated at runtime. To do so, you call <a href="qremoteobjectnode.html#acquireDynamic" translate="no">QRemoteObjectNode::acquireDynamic</a>(), passing in the source name (a <a href="../qtcore/qstring.html" translate="no">QString</a>) as an argument. Dynamic replicas are a bit more verbose to use from C++, but they do not require compilation. Dynamic replicas do not support initial property values, or introspection until they have been initialized.</p>
<p>An important difference between these two ways of creating replicas is the behavior before the replica is initialized. Since a dynamic replica only gets a metaObject after initialization, it has basically no API before initialization &ndash; no properties, and no signals to connect slots to.</p>
<p>Because metaObjects for compiled replicas are created at compile-time, their API is available when the replica is instantiated. You can even provide default values for properties in the template file, which are used until the replica is initialized with current values from the source.</p>
<h2 id="replica-initialization">Replica Initialization</h2>
<p>A host node will share the list of sources that it hosts with every other node that connects to it. This host sends updates when sources are added to or removed from the list. In this way, a connected node will always know what sources it can attach itself to. Changes to a specific source are only propagated to nodes that have a replica of that source. Consequently, this avoids any unnecessary network traffic.</p>
<p>When a node acquires a replica for a known source, it sends a request for that source to the host node. Upon receiving this request, the host creates a reply packet with the current values for all properties of that source. If the requested replica is <a href="qremoteobjectdynamicreplica.html" translate="no">dynamic</a>, the reply packet includes the API definition for the source. From then on, the replica's node will be included in the list of connections that receive changes to that source.</p>
<p>If a replica is instantiated but its node is not connected to the node that hosts the requested source &ndash; or that object lives in a host node process, but sharing/remoting has not been enabled for the <a href="../qtcore/qobject.html" translate="no">QObject</a> &ndash; the Replica will still be created, but remain uninitialized.</p>
<p>If, at a later time, the replica's node gets notified that the requested source is available from a connected node, at that point it will request the source and start the initialization process.</p>
<p>If the connection to a host node is lost, the replica will transition to the invalid state. It will attempt to reconnect and will re-initialize if the connection is restored; this makes sure all properties are current.</p>
<h2 id="replica-ownership">Replica Ownership</h2>
<p>The acquire methods return a pointer to the replica <a href="../qtcore/qobject.html" translate="no">QObject</a> instantiated by the node. The node has no way of knowing the replica's intended lifetime. Consequently, when the replica is not longer needed, it is the calling program's responsibility to delete it.</p>
<p>You can instantiate multiple copies of the same replica. All replicas of the same source from a single node will share a private data member which handles the network communication. This means multiple instances of a replica do not introduce additional network traffic, although there will be some additional processing overhead. Failing to delete replicas will prevent the reference count on this private object from reaching 0, and cause unnecessary network communication until the calling process exits. For this reason, it is recommended to use <a href="../qtcore/qscopedpointer.html" translate="no">QScopedPointer</a> or <a href="../qtcore/qsharedpointer.html" translate="no">QSharedPointer</a> to help track the lifetime of replicas.</p>
</div>
<!-- @@@qtremoteobjects-replica.html -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2024 <span translate="no">The Qt Company Ltd.</span>
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the <span translate="no">Free Software Foundation</span>.<br/>    <span translate="no">Qt</span> and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of <span translate="no">The Qt Company Ltd.</span> in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>
</div>
</body>
</html>
