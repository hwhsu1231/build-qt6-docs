<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- qtquick3dphysics-examples-mass.qdoc -->
  <meta name="description" content="Demonstrates different ways of setting mass and inertia of a body.">
  <title>Qt Quick 3D Physics - Mass Example | Qt Quick 3D Physics 6.6.0</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li><a href="../qtdoc/index.html" translate="no">Qt 6.6</a></li>
<li><a href="qtquick3dphysics-index.html" translate="no">Qt Quick 3D Physics</a></li>
<li><a href="quick3dphysics-examples.html" translate="no">Qt Quick 3D Physics Examples and Tutorials</a></li>
<li>Qt Quick 3D Physics - Mass Example</li>
<li id="buildversion"><a href="qtquick3dphysics-index.html" translate="no">Qt Quick 3D Physics | Commercial or GPLv3</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3 id="toc">Contents</h3>
<ul>
<li class="level1"><a href="#setup">Setup</a></li>
<li class="level1"><a href="#physical-objects">Physical objects</a></li>
<li class="level2"><a href="#shooting-balls">Shooting balls</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Qt Quick 3D Physics - Mass Example</h1>
<!-- $$$mass-brief -->
<p>Demonstrates different ways of setting mass and inertia of a body.</p>
<!-- @@@mass -->
<!-- $$$mass-description -->
<div class="descr" id="details">
<p class="centerAlign"><img src="images/mass-example.jpg" alt="" /></p><p>This example demonstrates three different ways of setting up the mass and inertia of a body. The scene consists of three bodies that consist of three spheres stacked vertically. These bodies all have the same mass but differing centers of mass and inertia tensors giving them different behavior when colliding.</p>
<h4 id="setup">Setup</h4>
<p>We first add our <a href="qml-qtquick3d-physics-physicsworld.html" translate="no">PhysicsWorld</a>:</p>
<pre class="qml" translate="no">
 <span class="type"><a href="qml-qtquick3d-physics-physicsworld.html" translate="no">PhysicsWorld</a></span> {
     <span class="name">running</span>: <span class="number">true</span>
     <span class="name">gravity</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0</span>, -<span class="number">9.81</span>, <span class="number">0</span>)
     <span class="name">typicalLength</span>: <span class="number">1</span>
     <span class="name">typicalSpeed</span>: <span class="number">10</span>
     <span class="name">scene</span>: <span class="name">viewport</span>.<span class="name">scene</span>
 }
</pre>
<p>We do the usual setup where we have an environment, camera and lights:</p>
<pre class="qml" translate="no">
 <span class="name">environment</span>: <span class="name">SceneEnvironment</span> {
     <span class="name">clearColor</span>: <span class="string">&quot;lightblue&quot;</span>
     <span class="name">backgroundMode</span>: <span class="name">SceneEnvironment</span>.<span class="name">Color</span>
 }

 <span class="type"><a href="../qtquick3d/qml-qtquick3d-perspectivecamera.html" translate="no">PerspectiveCamera</a></span> {
     <span class="name">id</span>: <span class="name">camera</span>
     <span class="name">position</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0</span>, <span class="number">2</span>, <span class="number">5</span>)
     <span class="name">eulerRotation</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(-<span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>)
     <span class="name">clipFar</span>: <span class="number">100</span>
     <span class="name">clipNear</span>: <span class="number">0.01</span>
 }

 <span class="type"><a href="../qtquick3d/qml-qtquick3d-directionallight.html" translate="no">DirectionalLight</a></span> {
     <span class="name">eulerRotation</span>.x: -<span class="number">45</span>
     <span class="name">eulerRotation</span>.y: <span class="number">45</span>
     <span class="name">castsShadow</span>: <span class="number">true</span>
     <span class="name">brightness</span>: <span class="number">1</span>
     <span class="name">shadowFactor</span>: <span class="number">100</span>
 }
</pre>
<h4 id="physical-objects">Physical objects</h4>
<p>We have our regular static plane:</p>
<pre class="qml" translate="no">
 <span class="type"><a href="qml-qtquick3d-physics-staticrigidbody.html" translate="no">StaticRigidBody</a></span> {
     <span class="name">position</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)
     <span class="name">eulerRotation</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(-<span class="number">90</span>, <span class="number">0</span>, <span class="number">0</span>)
     <span class="name">collisionShapes</span>: <span class="name">PlaneShape</span> {}
     <span class="type"><a href="../qtquick3d/qml-qtquick3d-model.html" translate="no">Model</a></span> {
         <span class="name">source</span>: <span class="string">&quot;#Rectangle&quot;</span>
         <span class="name">materials</span>: <span class="name">DefaultMaterial</span> {
             <span class="name">diffuseColor</span>: <span class="string">&quot;green&quot;</span>
         }
         <span class="name">castsShadows</span>: <span class="number">false</span>
         <span class="name">receivesShadows</span>: <span class="number">true</span>
     }
 }
</pre>
<p>We define a custom QML class for our body which we call RolyPoly since they behave like so called roly-poly toys. The RolyPoly is a <a href="qml-qtquick3d-physics-dynamicrigidbody.html" translate="no">DynamicRigidBody</a> with three spherical collision shapes:</p>
<pre class="qml" translate="no">
 <span class="type"><a href="qml-qtquick3d-physics-dynamicrigidbody.html" translate="no">DynamicRigidBody</a></span> {
     property <span class="type"><a href="../qtqml/qml-string.html" translate="no">string</a></span> <span class="name">color</span>: <span class="string">&quot;blue&quot;</span>

     <span class="name">collisionShapes</span>: [
         <span class="type"><a href="qml-qtquick3d-physics-sphereshape.html" translate="no">SphereShape</a></span> {
             <span class="name">id</span>: <span class="name">sphere0</span>
             <span class="name">diameter</span>:  <span class="number">1</span>
         },
         <span class="type"><a href="qml-qtquick3d-physics-sphereshape.html" translate="no">SphereShape</a></span> {
             <span class="name">id</span>: <span class="name">sphere1</span>
             <span class="name">diameter</span>:  <span class="number">0.8</span>
             <span class="name">position</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0</span>, <span class="number">0.6</span>, <span class="number">0</span>)
         },
         <span class="type"><a href="qml-qtquick3d-physics-sphereshape.html" translate="no">SphereShape</a></span> {
             <span class="name">id</span>: <span class="name">sphere2</span>
             <span class="name">diameter</span>:  <span class="number">0.6</span>
             <span class="name">position</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0</span>, <span class="number">1.1</span>, <span class="number">0</span>)
         }
     ]

     <span class="type"><a href="../qtquick3d/qml-qtquick3d-model.html" translate="no">Model</a></span> {
         <span class="name">source</span>: <span class="string">&quot;#Sphere&quot;</span>
         <span class="name">position</span>: <span class="name">sphere0</span>.<span class="name">position</span>
         <span class="name">scale</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>).<span class="name">times</span>(<span class="name">sphere0</span>.<span class="name">diameter</span><span class="operator">*</span><span class="number">0.01</span>)
         <span class="name">materials</span>: <span class="name">PrincipledMaterial</span> {
             <span class="name">baseColor</span>: <span class="name">color</span>
         }
     }

     <span class="type"><a href="../qtquick3d/qml-qtquick3d-model.html" translate="no">Model</a></span> {
         <span class="name">source</span>: <span class="string">&quot;#Sphere&quot;</span>
         <span class="name">position</span>: <span class="name">sphere1</span>.<span class="name">position</span>
         <span class="name">scale</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>).<span class="name">times</span>(<span class="name">sphere1</span>.<span class="name">diameter</span><span class="operator">*</span><span class="number">0.01</span>)
         <span class="name">materials</span>: <span class="name">PrincipledMaterial</span> {
             <span class="name">baseColor</span>: <span class="name">color</span>
         }
     }

     <span class="type"><a href="../qtquick3d/qml-qtquick3d-model.html" translate="no">Model</a></span> {
         <span class="name">source</span>: <span class="string">&quot;#Sphere&quot;</span>
         <span class="name">position</span>: <span class="name">sphere2</span>.<span class="name">position</span>
         <span class="name">scale</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>).<span class="name">times</span>(<span class="name">sphere2</span>.<span class="name">diameter</span><span class="operator">*</span><span class="number">0.01</span>)
         <span class="name">materials</span>: <span class="name">PrincipledMaterial</span> {
             <span class="name">baseColor</span>: <span class="name">color</span>
         }
     }
 }
</pre>
<p>We then add three roly-polys to our scene:</p>
<pre class="qml" translate="no">
 <span class="type">RolyPoly</span> {
     <span class="name">position</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(-<span class="number">2</span>, <span class="number">0.5</span>, <span class="number">0</span>)
     <span class="name">color</span>: <span class="string">&quot;blue&quot;</span>

     <span class="name">mass</span>: <span class="number">0.9</span>
     <span class="name">centerOfMassPosition</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0</span>, -<span class="number">0.5</span>, <span class="number">0</span>)
     <span class="name">inertiaTensor</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0.217011</span>, <span class="number">0.0735887</span>, <span class="number">0.217011</span>)
     <span class="name">massMode</span>: <span class="name">DynamicRigidBody</span>.<span class="name">MassAndInertiaTensor</span>
 }

 <span class="type">RolyPoly</span> {
     <span class="name">position</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0</span>, <span class="number">0.5</span>, <span class="number">0</span>)
     <span class="name">color</span>: <span class="string">&quot;purple&quot;</span>

     <span class="name">mass</span>: <span class="number">0.9</span>
     <span class="name">centerOfMassPosition</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0</span>, -<span class="number">0.5</span>, <span class="number">0</span>)
     <span class="name">inertiaTensor</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0.05</span>, <span class="number">100</span>, <span class="number">100</span>)
     <span class="name">massMode</span>: <span class="name">DynamicRigidBody</span>.<span class="name">MassAndInertiaTensor</span>
 }

 <span class="type">RolyPoly</span> {
     <span class="name">position</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">2</span>, <span class="number">0.5</span>, <span class="number">0</span>)
     <span class="name">color</span>: <span class="string">&quot;red&quot;</span>

     <span class="name">mass</span>: <span class="number">0.9</span>
     <span class="name">massMode</span>: <span class="name">DynamicRigidBody</span>.<span class="name">Mass</span>
 }
</pre>
<p>The purple and blue roly-poly has a custom center of mass and inertia tensor. Since bodies use uniform density by default and will calculate mass and inertia automatically we set massMode to <a href="qml-qtquick3d-physics-dynamicrigidbody.html" translate="no">DynamicRigidBody</a>.MassAndInertiaTensor in our purple and blue bodies to use our provided mass and inertia tensors instead. The lower center of mass will make it so the bodies will always stand up after being pushed over. The inertia tensor of the purple body makes it so it will wobble easily in one direction but hardly in the other. The red body has an automatically calculated center of mass and will therefore keep lying down after being knocked over.</p>
<h5 id="shooting-balls">Shooting balls</h5>
<p>To test out the behavior of the different bodies we add a Node for shooting balls:</p>
<pre class="qml" translate="no">
 <span class="type"><a href="../qtquick3d/qml-qtquick3d-node.html" translate="no">Node</a></span> {
     <span class="name">id</span>: <span class="name">shapeSpawner</span>
     property <span class="type"><a href="../qtqml/qml-var.html" translate="no">var</a></span> <span class="name">spheres</span>: []
     property <span class="type"><a href="../qtqml/qml-var.html" translate="no">var</a></span> <span class="name">sphereComponent</span>: <span class="name">Qt</span>.<span class="name">createComponent</span>(<span class="string">&quot;Sphere.qml&quot;</span>)

     <span class="keyword">function </span><span class="name">createBall</span>(position, forward) {
         let diameter = <span class="number">0.2</span>
         let speed = <span class="number">20</span>
         let sphere = <span class="name">sphereComponent</span>.<span class="name">createObject</span>(<span class="name">shapeSpawner</span>, {
                                                       &quot;position&quot;: <span class="name">position</span>,
                                                       &quot;sphereDiameter&quot;: <span class="name">diameter</span>
                                                   })
         <span class="name">sphere</span>.<span class="name">setLinearVelocity</span>(<span class="name">forward</span>.<span class="name">times</span>(<span class="name">speed</span>))

         var pair = {
             &quot;sphere&quot;: <span class="name">sphere</span>,
             &quot;date&quot;: <span class="name">Date</span>.<span class="name">now</span>()
         }

         <span class="name">spheres</span>.<span class="name">push</span>(<span class="name">pair</span>)

         <span class="keyword">if</span> (<span class="name">sphere</span> <span class="operator">===</span> <span class="number">null</span>) {
             <span class="name">console</span>.<span class="name">log</span>(<span class="string">&quot;Error creating object&quot;</span>)
         }
     }

     <span class="keyword">function </span><span class="name">clean</span>() {
         <span class="name">spheres</span> <span class="operator">=</span> <span class="name">spheres</span>.<span class="name">filter</span>(<span class="keyword"></span>sphere =&gt; {
             let diff = <span class="name">Date</span>.<span class="name">now</span>() <span class="operator">-</span> <span class="name">sphere</span>[<span class="string">'date'</span>];
             <span class="keyword">if</span> (<span class="name">diff</span> <span class="operator">&gt;</span> <span class="number">5000</span>) {
                 <span class="name">sphere</span>[<span class="string">'sphere'</span>].<span class="name">destroy</span>();
                 <span class="keyword">return</span> <span class="number">false</span>;
             }
             <span class="keyword">return</span> <span class="number">true</span>;
         });
     }

     <span class="type"><a href="../qtqml/qml-qtqml-timer.html" translate="no">Timer</a></span> {
         <span class="name">interval</span>: <span class="number">200</span>
         <span class="name">running</span>: <span class="number">true</span>
         <span class="name">repeat</span>: <span class="number">true</span>
         <span class="name">onTriggered</span>: <span class="name">shapeSpawner</span>.<span class="name">clean</span>()
     }
 }
</pre>
<p>We then add a <a href="../qtquick3d/qml-qtquick3d-helpers-wasdcontroller.html" translate="no">WasdController</a> to be able to move the camera and aim and shoot balls at the bodies:</p>
<pre class="qml" translate="no">
 <span class="type"><a href="../qtquick3d/qml-qtquick3d-helpers-wasdcontroller.html" translate="no">WasdController</a></span> {
     <span class="name">speed</span>: <span class="number">0.01</span>
     <span class="name">controlledObject</span>: <span class="name">camera</span>
     <span class="name">Keys</span>.onPressed: (<span class="keyword"></span>event) =&gt; {
         <span class="name">handleKeyPress</span>(<span class="name">event</span>);
         <span class="keyword">if</span> (<span class="name">event</span>.<span class="name">key</span> <span class="operator">===</span> <span class="name">Qt</span>.<span class="name">Key_Space</span>) {
             <span class="name">shapeSpawner</span>.<span class="name">createBall</span>(<span class="name">camera</span>.<span class="name">position</span>, <span class="name">camera</span>.<span class="name">forward</span>);
         }
     }
     <span class="name">Keys</span>.onReleased: (<span class="keyword"></span>event) =&gt; { <span class="name">handleKeyRelease</span>(<span class="name">event</span>) }
 }
</pre>
<p>Files:</p>
<ul>
<li><a href="qtquick3dphysics-mass-cmakelists-txt.html" translate="no">mass/CMakeLists.txt</a></li>
<li><a href="qtquick3dphysics-mass-rolypoly-qml.html" translate="no">mass/RolyPoly.qml</a></li>
<li><a href="qtquick3dphysics-mass-sphere-qml.html" translate="no">mass/Sphere.qml</a></li>
<li><a href="qtquick3dphysics-mass-main-cpp.html" translate="no">mass/main.cpp</a></li>
<li><a href="qtquick3dphysics-mass-main-qml.html" translate="no">mass/main.qml</a></li>
<li><a href="qtquick3dphysics-mass-mass-pro.html" translate="no">mass/mass.pro</a></li>
<li><a href="qtquick3dphysics-mass-qml-qrc.html" translate="no">mass/qml.qrc</a></li>
</ul>
</div>
<!-- @@@mass -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2023 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.<br/>    Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>
</div>
</body>
</html>
